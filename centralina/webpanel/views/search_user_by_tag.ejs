<% include header.ejs %>

<script type="text/javascript">
    var DATA_URL = '<%= api_url %>';
    var VIEW_URL = '<%= resources_url %>';
    $.ajaxSetup({ cache: false });
</script>

<script type="text/javascript">

function onClickSearch(e) {
    var tag_value = $('#form-tag-value').val();
    if(!tag_value) {
        $('.control-group').addClass('has-error');
        $('#form-tag-value').focus();
        return;
    } else {
        $('.control-group').removeClass('has-error');
    }

    var users_path = '/api/search-by-tag/'+tag_value;
    var users_list = new UsersList(users_path);

    return false;
}

function askTagToServer() {
    
    var path = DATA_URL+'/askTagToDeskNode';
    console.log(path)
    $.getJSON(path, function(tag) {
        console.log(tag);
        $('#form-tag-value').val(tag.value);    
    }).fail(function(e) {
        console.log( "search_user_by_tag > askTagToServer > error" );
    })
    
}

$(document).ready(function() {
    $("#readTag").click(function(e) {
        askTagToServer();
        return false;
    });
    $('#form-user-search').click(onClickSearch);
});

</script>

<div class="container">

    <div id="alerttt-placeholder"></div>

    <div class="breadcrumbs">
        <a href="/">Home</a> > Search user by tag
    </div>
    <h1>Search user by tag</h1>
    <div class="control-group">
        <form role="form">
            <button type="submit" class="btn btn-default" id="readTag" click="return false">Read tag from reader</button>
            <br><br>
            <div class="form-group">
                <input type="text" class="form-control" id="form-tag-value" placeholder="Tag value">
            </div>
            <button type="submit" class="btn btn-primary" id="form-user-search" click="return false">Search</button>
        </form>
    </div>

    <% include users_list.ejs %>    

</div>
<% include footer.ejs %>